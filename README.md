|||
|---|---|
|ДИСЦИПЛИНА|Фронтенд и бэкенд разработка|
|ИНСТИТУТ|ИПТИП|
|КАФЕДРА|Индустриального программирования|
|ВИД УЧЕБНОГО МАТЕРИАЛА|Методические указания к практическим занятиям|
|ПРЕПОДАВАТЕЛЬ|Астафьев Рустам Уралович|
|СЕМЕСТР|2 семестр, 2024/2025 уч. год|

---

### **Практическое занятие 18: Web App manifest**

---

## **Теоретическое введение**  
Web App Manifest — это JSON-файл, содержащий метаданные о вашем веб-приложении. Он позволяет браузерам и операционным системам понимать, как обрабатывать ваш сайт при добавлении на домашний экран, в каком цветовом оформлении его отображать и как запускать (в полноэкранном режиме, как отдельное приложение и т. д.).  

Манифест стал ключевым компонентом прогрессивных веб-приложений (PWA), так как именно он обеспечивает интеграцию с операционной системой устройства. Без правильно настроенного манифеста ваш сайт останется обычной вкладкой в браузере, даже если все остальные PWA-функции (Service Worker, офлайн-режим) работают корректно.  

Основные возможности, которые даёт манифест:  
- Установка иконки на домашний экран  
- Запуск в полноэкранном режиме (без интерфейса браузера)  
- Определение ориентации экрана (книжная, альбомная)  
- Установка цветов темы для адресной строки и интерфейса ОС  
- Указание стартовой страницы при запуске  

---

## **Практическая часть: создание и подключение манифеста**  

### **Шаг 1: Создание файла manifest.json**  
Создадим базовый манифест с обязательными и рекомендуемыми полями. Файл должен находиться в корне проекта.  

**manifest.json**  
```json
{
    "name": "Мое PWA",
    "short_name": "PWA",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#ffffff",
    "theme_color": "#4285f4",
    "description": "Пример прогрессивного веб-приложения",
    "orientation": "portrait-primary",
    "icons": [
      {
        "src": "icons/icon-16x16.png",
        "sizes": "72x72",
        "type": "image/png"
      },
      {
        "src": "icons/icon-32x32.png",
        "sizes": "96x96",
        "type": "image/png"
      },
      {
        "src": "icons/icon-192x192.png",
        "sizes": "192x192",
        "type": "image/png"
      },
      {
        "src": "icons/icon-512x512.png",
        "sizes": "512x512",
        "type": "image/png"
      }
    ]
  }
```

### **Шаг 2: Подключение манифеста к HTML**  
Добавим ссылку на манифест в тег `<head>` вашего index.html:  

**index.html**  
```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Мое PWA</title>
        
        <!-- Основной манифест -->
        <link rel="manifest" href="/manifest.json">
        
        <!-- Универсальный тег для установки на домашний экран -->
        <meta name="mobile-web-app-capable" content="yes">
        
        <!-- Цвет темы для адресной строки -->
        <meta name="theme-color" content="#4285f4">
        
        <!-- Иконки для iOS (по-прежнему требуют отдельного тега) -->
        <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
        
        <!-- Дополнительно: Splash Screen для iOS -->
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
      </head>
</head>
<body>
  <h1>Добро пожаловать в мое PWA!</h1>
</body>
</html>
```

### **Шаг 3: Подготовка иконок**  
Для корректного отображения на всех устройствах необходимо подготовить набор иконок разных размеров. Рекомендуемые размеры:  

- 72x72, 96x96, 128x128 (для старых Android)  
- 144x144, 152x152 (для iOS)  
- 192x192, 384x384 (для Android Chrome)  
- 512x512 (для splash screen)  

Создайте папку `icons` в корне проекта и поместите туда все подготовленные изображения. Можно использовать онлайн-генераторы иконок, например:  
- [RealFaviconGenerator](https://realfavicongenerator.net/)  
- [Favicon.io](https://favicon.io/)  

---

## **Тестирование и отладка**  
Запустите LiveServer

### **Проверка в Chrome DevTools**  
1. Откройте DevTools (**F12**)  
2. Перейдите на вкладку **Application → Manifest**  
3. Убедитесь, что:  
   - Манифест загружен без ошибок  
   - Все поля отображаются корректно  
   - Иконки доступны и имеют правильные MIME-типы  

### **Проверка установки**  
1. В Chrome на Android:  
   - Откройте сайт  
   - Должно появиться уведомление "Добавить на домашний экран"  
   - После установки приложение должно запускаться в полноэкранном режиме  

2. В Chrome на ПК:  
   - В правой части адресной строки должна быть кнопка "Установить"  

### **Частые проблемы и решения**  
- **Манифест не загружается** — проверьте путь к файлу и MIME-тип (должен быть `application/json`)  
- **Иконки не отображаются** — убедитесь, что пути в манифесте верные и файлы доступны  
- **Нет предложения установить** — проверьте, что:  
  - У вас работает Service Worker  
  - Сайт открыт по HTTPS (или localhost)  
  - В манифесте указаны `name`, `short_name` и `icons`  

---

## **Дополнительные возможности**  

### **Splash Screen**  
При запуске PWA на Android автоматически показывается заставка, которая формируется на основе:  
- `background_color` из манифеста  
- Иконки 512x512  
- `theme_color`  

Для кастомизации можно использовать:  
```json
"background_color": "#ffffff",
"theme_color": "#4285f4",
"icons": [{
  "src": "icons/splash-512x512.png",
  "sizes": "512x512",
  "type": "image/png",
  "purpose": "maskable any"
}]
```

### **Ориентация экрана**  
Вы можете зафиксировать ориентацию:  
```json
"orientation": "portrait" // или "landscape", "natural"
```

### **Scope и Start URL**  
Эти параметры определяют, какие страницы будут считаться частью PWA:  
```json
"scope": "/",
"start_url": "/?utm_source=pwa"
```

---

## **Заключение**  
Правильно настроенный Web App Manifest превращает ваш сайт в полноценное приложение, которое можно установить на домашний экран. Основные моменты для запоминания:  

1. Манифест должен быть валидным JSON-файлом  
2. Обязательные поля: `name`, `start_url`, `display`, `icons`  
3. Для iOS требуются дополнительные meta-теги  
4. Тестируйте на реальных устройствах  

Перейдем к Базовому заданию №7
